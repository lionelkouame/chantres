# ADR-003 â€“ Indexation et ReadModel

**Statut** : AcceptÃ©e
**Date** : 2025-05-08

## Contexte

Dans notre architecture CQRS (Command Query Responsibility Segregation), les commandes modifient l'Ã©tat via des agrÃ©gats et les lectures sont servies par des projections dÃ©rivÃ©es de l'historique des Ã©vÃ©nements (Event Sourcing). Le projet de gestion de chorale implique de nombreuses requÃªtes dynamiques : filtres, tris, recherche plein texte sur les chants, les membres, les activitÃ©s, les performances passÃ©es.

## DÃ©cision

Tous les Read Models du projet seront gÃ©rÃ©s via **OpenSearch**. Les projections seront crÃ©Ã©es et synchronisÃ©es Ã  partir des Ã©vÃ©nements de domaine, et stockÃ©es dans des index OpenSearch consultables via lâ€™API.

## Justifications

* ğŸ” **Excellentes capacitÃ©s de recherche** : plein texte, analyzers, filtres, agrÃ©gations, pertinence, etc.
* âš¡ **Performance de lecture** : optimisÃ© pour le temps de rÃ©ponse rapide, mÃªme sur de gros volumes.
* ğŸ” **Alignement avec Event Sourcing** : projection asynchrone des Ã©vÃ©nements sur des documents OpenSearch.
* ğŸ“Š **Exploration et monitoring** : via OpenSearch Dashboards, pour lâ€™analyse de lâ€™activitÃ© ou la vÃ©rification des projections.
* âš™ï¸ **IntÃ©gration aisÃ©e** : requÃªtage REST/JSON compatible avec les frontends modernes.

## ConsÃ©quences

* ğŸ“¥ Chaque Ã©vÃ©nement significatif devra Ãªtre projetÃ© vers un index spÃ©cifique OpenSearch.
* ğŸ§ª Les tests devront simuler ou contrÃ´ler l'Ã©tat des index.
* ğŸ”„ La rÃ©gÃ©nÃ©ration des projections devra Ãªtre automatisable (replay d'Ã©vÃ©nements).
* ğŸ› ï¸ Des outils de supervision de la synchronisation (Ã©vÃ©nements -> index) devront Ãªtre en place.
* ğŸ§° L'Ã©quipe devra maÃ®triser le DSL OpenSearch et ses mÃ©canismes dâ€™indexation/rafraÃ®chissement.

## Alternatives envisagÃ©es

* PostgreSQL avec JSONB : plus simple, mais moins performant pour la recherche textuelle.
* MongoDB : offre aussi des capacitÃ©s de requÃªtage documentaires, mais moins spÃ©cialisÃ©es en plein texte.

---

Les futurs Read Models devront Ãªtre dÃ©clarÃ©s avec leur source d'Ã©vÃ©nements et leur schÃ©ma d'indexation.
